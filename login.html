<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>VoteHub â€” Login</title>
  <link rel="stylesheet" href="stl.css" />
</head>
<body class="bg-900">
  <main class="site-main">
    <div class="auth-card max-w-4xl mx-auto">
      <h2 class="text-3xl font-bold mb-4 text-center bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent animate-gradient-flow bg-300%">Login to VoteHub</h2>
      <form id="loginForm" aria-label="Login Form" class="space-y-6">
        <input class="form-input" type="email" id="email" placeholder="Email" required />
        <input class="form-input" type="password" id="password" placeholder="Password" required />
        <button class="btn-primary w-full" type="submit" id="loginBtn">Login</button>
        <div id="errorBanner" class="notification error" style="display:none"></div>
      </form>
      <div class="mt-4 text-center">
        <a href="register.html" class="btn-secondary">Register</a>
      </div>
    </div>
  </main>
  <script>
    function getItem(key, fallback) {
      try { return JSON.parse(localStorage.getItem(key)) ?? fallback; } catch { return fallback; }
    }
    function setItem(key, val) {
      try { localStorage.setItem(key, JSON.stringify(val)); } catch {}
    }
    function hash(str) {
      let h = 0; for (let i = 0; i < str.length; i++) h = ((h<<5)-h)+str.charCodeAt(i); return h.toString();
    }
    function normalize(str) { return str.trim().toLowerCase(); }
    function login({ email, password }) {
      const users = getItem('LS_USERS', []);
      const user = users.find(u => normalize(u.email) === normalize(email));
      if (!user) return { error: 'User not found' };
      if (user.passwordHash !== hash(password)) return { error: 'Wrong password' };
      setItem('LS_SESSION', { userId: user.id, createdAt: Date.now() });
      return { user };
    }
    const form = document.getElementById('loginForm');
    const errorBanner = document.getElementById('errorBanner');
    form.addEventListener('submit', function(e) {
      e.preventDefault();
      form.loginBtn.disabled = true;
      errorBanner.style.display = 'none';
      const email = form.email.value;
      const password = form.password.value;
      const result = login({ email, password });
      if (result.error) {
        errorBanner.textContent = result.error;
        errorBanner.style.display = 'block';
        form.loginBtn.disabled = false;
      } else {
        window.location = 'index.html';
      }
    });
  </script>
</body>
</html>
